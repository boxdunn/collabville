package seedlings {	import flash.display.MovieClip;	import flash.events.MouseEvent;	import flash.events.Event;	import flash.filters.GlowFilter;		public class Pot extends MovieClip{		private var type:int = 0;		private var cangrow:Function		private var reward:Function		//Encrease this number to let growing of flowers take longer		private var growbase:Number = 1000		public function Pot(type:int, cangrow:Function, reward:Function) {			//Can we grow request method			this.cangrow = cangrow;			//Give reward request method			this.reward = reward			//Define type of flower			this.type = type;			//Stop frames			stop();			//Add event handlers			this.addEventListener(MouseEvent.CLICK, handleClick)			this.addEventListener(MouseEvent.MOUSE_OVER, handleMouseOver);			this.addEventListener(MouseEvent.MOUSE_OUT, handleMouseOut);			this.addEventListener(Event.ENTER_FRAME, handleEnterFrame);			//Give object a hand cursor			this.useHandCursor = true;			this.buttonMode = true;			//Hide progressbar			progress.visible = false		}				//Return the state of the flower pot		public function get state():int{			return currentFrame		}		//Set state to s		public function set state(s:int):void{			gotoAndStop(s)		}		//Handle click		private function handleClick(e:MouseEvent):void{			//Only upgrade if flower is not already growing			if(!progress.visible)				upgrade();		}						private var time:Number = 0		private function upgrade():void{			//If we can grow (Have energy)			if( cangrow() ){				//Show progressbar				progress.setProgress(0)				progress.visible = true;				//Set time to now				time = new Date().getTime();			}		}				private function handleEnterFrame(e:Event):void{			var growtime:Number = growbase * Math.min(currentFrame,5)			//If we are growing			if(progress.visible){				//Determine how far we have grown				var offset:Number = (new Date().getTime() - time);				//Set progress				progress.setProgress( offset/growtime )								//IF we are done growing				var a:int = 0;				if(offset/growtime>=1){					//Hide progressbar					progress.visible = false;					//If we have grown a full flower					if(currentFrame == 4 || currentFrame == 16){						//Show flower by going to related frame						gotoAndStop(type+5)						for( a=0;a<Math.min(currentFrame, 4);a++) reward(this)					}else if(currentFrame<4){						//Else show seedling						for( a=0;a<Math.min(currentFrame, 4);a++) reward(this)						nextFrame();					}else{						//We had a full flower, award user 5 flowers for killing it						for( a=0;a<5;a++) reward(this)						gotoAndStop(1);					}				}			}						//If we have a full flower, randomly spawn stars			if(currentFrame > 4 && currentFrame<16 && Math.random()<0.001){				reward(this);			}		}		//Mouse hover effect		private function handleMouseOver(e:MouseEvent):void{			this.filters = [new GlowFilter(0xffffff, 1, 4, 4, 10, 3)];					}		private function handleMouseOut(e:MouseEvent):void{			this.filters = [];		}	}	}